<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>File: iptables [RDoc Documentation]</title>

  <link type="text/css" media="screen" href="../../../rdoc.css" rel="stylesheet" />

  <script src="../../../js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>
</head>

<body class="file">
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../../index.html">Home</a>
          <a href="../../../index.html#classes">Classes</a>
          <a href="../../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../../../lib/helpers/input/apache_users_long_txt.html">apache_users_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/dns_hosts_long_txt.html">dns_hosts_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/ftp_pwds_long_txt.html">ftp_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/ftp_usrs_long_txt.html">ftp_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/iptables.html">iptables</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/iptables_logrotate.html">iptables_logrotate</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/korelogic_rules_txt.html">korelogic_rules.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/mssql_pwds_long_txt.html">mssql_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/mssql_usrs_long_txt.html">mssql_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/mysql_pwds_long_txt.html">mysql_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/mysql_usrs_long_txt.html">mysql_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/oracle_pwds_long_txt.html">oracle_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/oracle_usrs_long_txt.html">oracle_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/postgresql_pwds_long_txt.html">postgresql_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/postgresql_usrs_long_txt.html">postgresql_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/snmp_comm_strings_long_txt.html">snmp_comm_strings_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/ssh_pwds_long_txt.html">ssh_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/ssh_usrs_long_txt.html">ssh_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/telnet_pwds_long_txt.html">telnet_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/telnet_usrs_long_txt.html">telnet_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/tftp_file_list_txt.html">tftp_file_list.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/vnc_pwds_long_txt.html">vnc_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/vnc_usrs_long_txt.html">vnc_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/vpn_group_id_long_txt.html">vpn_group_id_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/windows_pwds_long_txt.html">windows_pwds_long.txt</a></li>
        
          <li class="file"><a href="../../../lib/helpers/input/windows_usrs_long_txt.html">windows_usrs_long.txt</a></li>
        
          <li class="file"><a href="../../../licenses/COPYING.html">COPYING</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class Index
          <span class="search-toggle"><img src="../../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../../ApacheUsers.html">ApacheUsers</a></li>
        
          <li><a href="../../../Atftpd.html">Atftpd</a></li>
        
          <li><a href="../../../Cewl.html">Cewl</a></li>
        
          <li><a href="../../../ConfigSnort.html">ConfigSnort</a></li>
        
          <li><a href="../../../CustomDictionary.html">CustomDictionary</a></li>
        
          <li><a href="../../../DNS.html">DNS</a></li>
        
          <li><a href="../../../DNSrecon.html">DNSrecon</a></li>
        
          <li><a href="../../../DiG.html">DiG</a></li>
        
          <li><a href="../../../Dictionary.html">Dictionary</a></li>
        
          <li><a href="../../../DictionaryOnline.html">DictionaryOnline</a></li>
        
          <li><a href="../../../DirStructure.html">DirStructure</a></li>
        
          <li><a href="../../../DiscoverServices.html">DiscoverServices</a></li>
        
          <li><a href="../../../Dsniff.html">Dsniff</a></li>
        
          <li><a href="../../../Enum4linux.html">Enum4linux</a></li>
        
          <li><a href="../../../FTP.html">FTP</a></li>
        
          <li><a href="../../../Fierce.html">Fierce</a></li>
        
          <li><a href="../../../GExeption.html">GExeption</a></li>
        
          <li><a href="../../../GNmap.html">GNmap</a></li>
        
          <li><a href="../../../GatherInfo.html">GatherInfo</a></li>
        
          <li><a href="../../../Gladius.html">Gladius</a></li>
        
          <li><a href="../../../Gpty.html">Gpty</a></li>
        
          <li><a href="../../../HTTP.html">HTTP</a></li>
        
          <li><a href="../../../Home.html">Home</a></li>
        
          <li><a href="../../../Hydra.html">Hydra</a></li>
        
          <li><a href="../../../IPtables.html">IPtables</a></li>
        
          <li><a href="../../../John.html">John</a></li>
        
          <li><a href="../../../KaliSupport.html">KaliSupport</a></li>
        
          <li><a href="../../../MSF.html">MSF</a></li>
        
          <li><a href="../../../Medusa.html">Medusa</a></li>
        
          <li><a href="../../../Menu.html">Menu</a></li>
        
          <li><a href="../../../Ncrack.html">Ncrack</a></li>
        
          <li><a href="../../../NetbiosSMB.html">NetbiosSMB</a></li>
        
          <li><a href="../../../NetworkAttacks.html">NetworkAttacks</a></li>
        
          <li><a href="../../../Nikto.html">Nikto</a></li>
        
          <li><a href="../../../NmapParser.html">NmapParser</a></li>
        
          <li><a href="../../../Object.html">Object</a></li>
        
          <li><a href="../../../Parse.html">Parse</a></li>
        
          <li><a href="../../../ParseFile.html">ParseFile</a></li>
        
          <li><a href="../../../Path.html">Path</a></li>
        
          <li><a href="../../../SMTP.html">SMTP</a></li>
        
          <li><a href="../../../SNMP.html">SNMP</a></li>
        
          <li><a href="../../../SSLScan.html">SSLScan</a></li>
        
          <li><a href="../../../Session.html">Session</a></li>
        
          <li><a href="../../../SniffSpoof.html">SniffSpoof</a></li>
        
          <li><a href="../../../SnortService.html">SnortService</a></li>
        
          <li><a href="../../../Splash.html">Splash</a></li>
        
          <li><a href="../../../SysInfo.html">SysInfo</a></li>
        
          <li><a href="../../../TFTP.html">TFTP</a></li>
        
          <li><a href="../../../TestSSLServer.html">TestSSLServer</a></li>
        
          <li><a href="../../../VPNAttacks.html">VPNAttacks</a></li>
        
          <li><a href="../../../Weapon.html">Weapon</a></li>
        
          <li><a href="../../../WebAttacks.html">WebAttacks</a></li>
        
          <li><a href="../../../WirelessAttacks.html">WirelessAttacks</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    
<p>#! /bin/bash</p>

<p>###########################################################################
# Configure this ruleset and logging
###########################################################################
# iptables -L -nv # vi /etc/init.d iptables # Drop the contents of this
file in # chown root /etc/init.d;chmod 700 /etc/init.d/iptables # touch
/var/log/iptables.log;chmod 600 /var/log/iptables.log # echo ‘kern.warning
/var/log/iptables.log’ |cat &gt;&gt; /etc/syslog.conf # service rsyslog
restart # update-rc.d iptables defaults # /etc/init.d/iptables restart #
iptables -L -nv</p>

<p>###########################################################################
# FLUSH ALL
###########################################################################
# Flush all rules. /sbin/iptables -F</p>

<p>###########################################################################
# INBOUND
###########################################################################</p>

<p>######################### # LOGGING ALL ######################### # Log ALL
inbound.  Are you sure? #/sbin/iptables -A INPUT -j LOG –log-level 4</p>

<p>######################### # SUSPICIOUS or NOISY ######################### #
Drop suspicious sources. #/sbin/iptables -A INPUT -s 10.0.0.0/8 -j DROP
#/sbin/iptables -A INPUT -s 172.16.0.0/12 -j DROP #/sbin/iptables -A INPUT
-s 192.168.0.0/16 -j DROP #/sbin/iptables -A INPUT -s 224.0.0.0/4 -j DROP
#/sbin/iptables -A INPUT -s 240.0.0.0/5 -j DROP #/sbin/iptables -A INPUT -s
0.0.0.0/8 -j DROP #/sbin/iptables -A INPUT -s 169.254.0.0/16 -j DROP</p>

<p>######################### # ESTABLISHED, RELATED #########################
# Accept established and related sessions to recieve traffic.
/sbin/iptables -A INPUT -m state –state ESTABLISHED,RELATED -j ACCEPT</p>

<p>######################### # LOOPBACK ######################### # Accept
incoming on loopback. /sbin/iptables -A INPUT -i lo -j ACCEPT</p>

<p>######################### # <a href="../../../MSF.html">MSF</a> Reverse
######################### #/sbin/iptables -A INPUT -p tcp –dport 443 -j
ACCEPT #/sbin/iptables -A INPUT -p udp –dport 443 -j ACCEPT</p>

<p>######################### # <a href="../../../TFTP.html">TFTP</a>
######################### #/sbin/iptables -A INPUT -p udp –dport 69 -j
ACCEPT</p>

<p>######################### # <a href="../../../HTTP.html">HTTP</a>
######################### # Accept incoming http traffic to Apache.
#/sbin/iptables -A INPUT  -p tcp –dport 80 -j ACCEPT</p>

<p>######################### # HTTPS ######################### # Accept
incoming https traffic to Apache. #/sbin/iptables -A INPUT -p tcp –dport
443 -j ACCEPT</p>

<p>######################### # SSH ######################### # Accept incoming
ssh traffic from a subnet #/sbin/iptables -A INPUT -s 10.0.0.0/24 -p tcp
–dport 22 -j ACCEPT</p>

<p>######################### # ICMP ######################### # Accept
incoming icmp requests. #/sbin/iptables -A INPUT -s 10.0.0.0/24 -p icmp
–icmp-type 8 -j ACCEPT</p>

<p>######################### # <a href="../../../SNMP.html">SNMP</a>
######################### # Accept incoming <a
href="../../../SNMP.html">SNMP</a> queries. #/sbin/iptables -A INPUT -p tcp
–dport 161 -j ACCEPT #/sbin/iptables -A INPUT -p udp –dport 161 -j ACCEPT</p>

<p># Accept incoming SNMPTRAP queries. #/sbin/iptables -A INPUT -p tcp –dport
162 -j ACCEPT #/sbin/iptables -A INPUT -p udp –dport 162 -j ACCEPT</p>

<p>######################### # LOGGING ALL ELSE ######################### #
Log all else inbound.  Really? /sbin/iptables -A INPUT -j LOG –log-level 4
–log-prefix “  Dropped: ”</p>

<p>######################### # DROP ALL ELSE ######################### # Drop
all else inbound. /sbin/iptables -A INPUT -j DROP</p>

<p>############################################################################
# OUTBOUND
############################################################################</p>

<p>######################### # PERMITTING ALL #########################</p>

<p>############################################################################
# FORWARD
############################################################################</p>

<p>######################### # DROP ALL ######################### # Drop all
forwards. /sbin/iptables -A FORWARD -j DROP</p>

  </div>

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>
</body>
</html>

