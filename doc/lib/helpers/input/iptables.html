<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>iptables - RDoc Documentation</title>

<link type="text/css" media="screen" href="../../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../js/darkfish.js"></script>


<body class="file">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../../index.html">Home</a>
    <a href="../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../../../README_md.html">README</a>
  
    <li class="file"><a href="../../../bin/mysql_sh.html">mysql.sh</a>
  
    <li class="file"><a href="../../../doc/created_rid.html">created.rid</a>
  
    <li class="file"><a href="../../../hydra_2014-02-17_08-50-38_txt.html">hydra_2014-02-17_08-50-38</a>
  
    <li class="file"><a href="../../../lib/helpers/input/apache_users_long_txt.html">apache_users_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/dns_hosts_long_txt.html">dns_hosts_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/ftp_pwds_long_txt.html">ftp_pwds_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/ftp_usrs_long_txt.html">ftp_usrs_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/gladius_conf.html">gladius.conf</a>
  
    <li class="file"><a href="../../../lib/helpers/input/iptables.html">iptables</a>
  
    <li class="file"><a href="../../../lib/helpers/input/iptables_logrotate.html">iptables_logrotate</a>
  
    <li class="file"><a href="../../../lib/helpers/input/mysql_pwds_long_txt.html">mysql_pwds_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/mysql_usrs_long_txt.html">mysql_usrs_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/postgresql_pwds_long_txt.html">postgresql_pwds_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/postgresql_usrs_long_txt.html">postgresql_usrs_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/snmp_comm_strings_long_txt.html">snmp_comm_strings_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/ssh_pwds_long_txt.html">ssh_pwds_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/ssh_usrs_long_txt.html">ssh_usrs_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/stdn_hosts_txt.html">stdn_hosts</a>
  
    <li class="file"><a href="../../../lib/helpers/input/stdn_pwds_txt.html">stdn_pwds</a>
  
    <li class="file"><a href="../../../lib/helpers/input/stdn_usrs_txt.html">stdn_usrs</a>
  
    <li class="file"><a href="../../../lib/helpers/input/telnet_pwds_long_txt.html">telnet_pwds_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/telnet_usrs_long_txt.html">telnet_usrs_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/tftp_file_list_txt.html">tftp_file_list</a>
  
    <li class="file"><a href="../../../lib/helpers/input/vpn_group_id_long_txt.html">vpn_group_id_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/windows_pwds_long_txt.html">windows_pwds_long</a>
  
    <li class="file"><a href="../../../lib/helpers/input/windows_usrs_long_txt.html">windows_usrs_long</a>
  
    <li class="file"><a href="../../../nmap_2014-02-17_08-49-32_csv.html">nmap_2014-02-17_08-49-32.csv</a>
  
    <li class="file"><a href="../../../nmap_2014-02-17_08-49-32_gnmap.html">nmap_2014-02-17_08-49-32.gnmap</a>
  
    <li class="file"><a href="../../../nmap_2014-02-17_08-49-32_nmap.html">nmap_2014-02-17_08-49-32.nmap</a>
  
    <li class="file"><a href="../../../nmap_2014-02-17_08-49-32_xml.html">nmap_2014-02-17_08-49-32.xml</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../../ApacheUsers.html">ApacheUsers</a>
  
    <li><a href="../../../Atftpd.html">Atftpd</a>
  
    <li><a href="../../../ConfigSnort.html">ConfigSnort</a>
  
    <li><a href="../../../Constant.html">Constant</a>
  
    <li><a href="../../../DNS.html">DNS</a>
  
    <li><a href="../../../DNSrecon.html">DNSrecon</a>
  
    <li><a href="../../../DiG.html">DiG</a>
  
    <li><a href="../../../Dictionary.html">Dictionary</a>
  
    <li><a href="../../../DictionaryOnline.html">DictionaryOnline</a>
  
    <li><a href="../../../DirStructure.html">DirStructure</a>
  
    <li><a href="../../../DiscoverServices.html">DiscoverServices</a>
  
    <li><a href="../../../Dsniff.html">Dsniff</a>
  
    <li><a href="../../../FTP.html">FTP</a>
  
    <li><a href="../../../Fierce.html">Fierce</a>
  
    <li><a href="../../../GExeption.html">GExeption</a>
  
    <li><a href="../../../GNmap.html">GNmap</a>
  
    <li><a href="../../../GatherInfo.html">GatherInfo</a>
  
    <li><a href="../../../Gladius.html">Gladius</a>
  
    <li><a href="../../../Gpty.html">Gpty</a>
  
    <li><a href="../../../HTTP.html">HTTP</a>
  
    <li><a href="../../../Home.html">Home</a>
  
    <li><a href="../../../Hydra.html">Hydra</a>
  
    <li><a href="../../../IPtables.html">IPtables</a>
  
    <li><a href="../../../KaliSupport.html">KaliSupport</a>
  
    <li><a href="../../../MSF.html">MSF</a>
  
    <li><a href="../../../Menu.html">Menu</a>
  
    <li><a href="../../../Ncrack.html">Ncrack</a>
  
    <li><a href="../../../NetbiosSMB.html">NetbiosSMB</a>
  
    <li><a href="../../../NetworkAttacks.html">NetworkAttacks</a>
  
    <li><a href="../../../Nikto.html">Nikto</a>
  
    <li><a href="../../../NmapParser.html">NmapParser</a>
  
    <li><a href="../../../Object.html">Object</a>
  
    <li><a href="../../../Parse.html">Parse</a>
  
    <li><a href="../../../ParseFile.html">ParseFile</a>
  
    <li><a href="../../../Path.html">Path</a>
  
    <li><a href="../../../SMTP.html">SMTP</a>
  
    <li><a href="../../../SNMP.html">SNMP</a>
  
    <li><a href="../../../SSLScan.html">SSLScan</a>
  
    <li><a href="../../../Session.html">Session</a>
  
    <li><a href="../../../SniffSpoof.html">SniffSpoof</a>
  
    <li><a href="../../../SnortService.html">SnortService</a>
  
    <li><a href="../../../Splash.html">Splash</a>
  
    <li><a href="../../../SysInfo.html">SysInfo</a>
  
    <li><a href="../../../TFTP.html">TFTP</a>
  
    <li><a href="../../../VPNAttacks.html">VPNAttacks</a>
  
    <li><a href="../../../Weapon.html">Weapon</a>
  
    <li><a href="../../../WebAttacks.html">WebAttacks</a>
  
    <li><a href="../../../WirelessAttacks.html">WirelessAttacks</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation" class="description">
  
<p>#! /bin/bash</p>

<p>###########################################################################
# FLUSH ALL
###########################################################################
# Flush all rules. /sbin/iptables -F</p>

<p>###########################################################################
# INBOUND
###########################################################################</p>

<p>######################### # LOGGING ALL ######################### # Log ALL
inbound.  Are you sure? #/sbin/iptables -A INPUT -j LOG –log-level 4</p>

<p>######################### # SUSPICIOUS or NOISY ######################### #
Drop suspicious sources. #/sbin/iptables -A INPUT -s 10.0.0.0/8 -j DROP
#/sbin/iptables -A INPUT -s 172.16.0.0/12 -j DROP #/sbin/iptables -A INPUT
-s 192.168.0.0/16 -j DROP /sbin/iptables -A INPUT -s 224.0.0.0/4 -j DROP
/sbin/iptables -A INPUT -s 240.0.0.0/5 -j DROP /sbin/iptables -A INPUT -s
0.0.0.0/8 -j DROP /sbin/iptables -A INPUT -s 169.254.0.0/16 -j DROP</p>

<p>######################### # ESTABLISHED, RELATED #########################
# Accept established and related sessions to recieve traffic.
/sbin/iptables -A INPUT -m state –state ESTABLISHED,RELATED -j ACCEPT</p>

<p>######################### # LOOPBACK ######################### # Accept
incoming on loopback. /sbin/iptables -A INPUT -i lo -j ACCEPT</p>

<p>######################### # <a href="../../../MSF.html">MSF</a> Reverse
######################### #/sbin/iptables -A INPUT -p tcp –dport 443 -j
ACCEPT #/sbin/iptables -A INPUT -p udp –dport 443 -j ACCEPT</p>

<p>######################### # <a href="../../../TFTP.html">TFTP</a>
######################### #/sbin/iptables -A INPUT -p udp –dport 69 -j
ACCEPT</p>

<p>######################### # <a href="../../../HTTP.html">HTTP</a>
######################### # Accept incoming http traffic to Apache.
#/sbin/iptables -A INPUT  -p tcp –dport 80 -j ACCEPT</p>

<p>######################### # HTTPS ######################### # Accept
incoming https traffic to Apache. #/sbin/iptables -A INPUT -p tcp –dport
443 -j ACCEPT</p>

<p>######################### # SSH ######################### # Accept incoming
ssh traffic from a subnet #/sbin/iptables -A INPUT -s 10.0.0.0/24 -p tcp
–dport 22 -j ACCEPT</p>

<p>######################### # ICMP ######################### # Accept
incoming icmp requests. #/sbin/iptables -A INPUT -s 10.0.0.0/24 -p icmp
–icmp-type 8 -j ACCEPT</p>

<p>######################### # <a href="../../../SNMP.html">SNMP</a>
######################### # Accept incoming <a
href="../../../SNMP.html">SNMP</a> queries. #/sbin/iptables -A INPUT -p tcp
–dport 161 -j ACCEPT #/sbin/iptables -A INPUT -p udp –dport 161 -j ACCEPT</p>

<p># Accept incoming SNMPTRAP queries. #/sbin/iptables -A INPUT -p tcp –dport
162 -j ACCEPT #/sbin/iptables -A INPUT -p udp –dport 162 -j ACCEPT</p>

<p>######################### # LOGGING ALL ELSE ######################### #
Log all else inbound.  Really? /sbin/iptables -A INPUT -j LOG –log-level 4
–log-prefix “  Dropped: ”</p>

<p>######################### # DROP ALL ELSE ######################### # Drop
all else inbound. /sbin/iptables -A INPUT -j DROP</p>

<p>############################################################################
# OUTBOUND
############################################################################</p>

<p>######################### # PERMITTING ALL #########################</p>

<p>############################################################################
# FORWARD
############################################################################</p>

<p>######################### # DROP ALL ######################### # Drop all
forwards. /sbin/iptables -A FORWARD -j DROP</p>

</div>



<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.1.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

